-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /home/research/ca_ed_lab/users/chesun/gsr/caschls/log/build/sample
> /pooledsecdemographics.smcl
  log type:  smcl
 opened on:  25 Jul 2022, 18:09:39

. 
. local years 1415 1516 1617 1718 1819 //local macro for dataset years

. 
. /* reconstruct secondary demographics datasets for pooling across years */
. local runsecforpooling = 1 //local toggle for reconstructing secondary demogr
> aphics data for pooling

. if `runsecforpooling' == 1 {
.  foreach year of local years {
  2.    use $projdir/dta/demographics/secondary/secdemo`year', replace
  3.    replace gr9asianenr = gr9asianenr + gr9filipinoenr
  4.    replace gr11asianenr = gr11asianenr + gr11filipinoenr
  5.    keep cdscode svygr9 svygr11 svyfemalegr9 svyfemalegr11 svymalegr9 svyma
> legr11 ///
>    svyhispanicgr9 svyhispanicgr11 svyasiangr9 svyasiangr11 svyblackgr9 svybla
> ckgr11 svywhitegr9 svywhitegr11 ///
>    gr9enr gr11enr gr9femaleenr gr9maleenr gr11femaleenr gr11maleenr ///
>    gr9asianenr gr9hispanicenr gr9blackenr gr9whiteenr ///
>    gr11asianenr gr11hispanicenr gr11blackenr gr11whiteenr
  6. 
.    gen year = `year' //generate a variable for the survey year
  7.    tostring year, replace //make into string
  8.    label var year "survey year"
  9. 
.    compress
 10.    save $projdir/dta/demographics/pooled/forpooling/secondary/secdemoforpo
> oling`year', replace
 11.  }
(292 real changes made)
(305 real changes made)
year was float now str4
  (0 bytes saved)
file
    /home/research/ca_ed_lab/users/chesun/gsr/caschls/dta/demographics/pooled
    > /forpooling/secondary/secdemoforpooling1415.dta saved
(2015-16 secondary CHKS data)
(413 real changes made)
(464 real changes made)
year was float now str4
  (0 bytes saved)
file
    /home/research/ca_ed_lab/users/chesun/gsr/caschls/dta/demographics/pooled
    > /forpooling/secondary/secdemoforpooling1516.dta saved
(2016-17 Secondary CHKS Data)
(365 real changes made)
(385 real changes made)
year was float now str4
  (0 bytes saved)
file
    /home/research/ca_ed_lab/users/chesun/gsr/caschls/dta/demographics/pooled
    > /forpooling/secondary/secdemoforpooling1617.dta saved
(2017-18 Secondary CHKS Data)
(451 real changes made)
(507 real changes made)
year was float now str4
  (0 bytes saved)
file
    /home/research/ca_ed_lab/users/chesun/gsr/caschls/dta/demographics/pooled
    > /forpooling/secondary/secdemoforpooling1718.dta saved
(2018-19 Secondary CHKS Data)
(410 real changes made)
(440 real changes made)
year was float now str4
  (0 bytes saved)
file
    /home/research/ca_ed_lab/users/chesun/gsr/caschls/dta/demographics/pooled
    > /forpooling/secondary/secdemoforpooling1819.dta saved
. }

. 
. /* append all secondary datasets to construct a panel dataset */
. use $projdir/dta/demographics/pooled/forpooling/secondary/secdemoforpooling14
> 15, replace

. append using $projdir/dta/demographics/pooled/forpooling/secondary/secdemofor
> pooling1516

. append using $projdir/dta/demographics/pooled/forpooling/secondary/secdemofor
> pooling1617

. append using $projdir/dta/demographics/pooled/forpooling/secondary/secdemofor
> pooling1718

. append using $projdir/dta/demographics/pooled/forpooling/secondary/secdemofor
> pooling1819

. 
. compress
  (0 bytes saved)

. save $projdir/dta/demographics/pooled/paneldata/secdemopanel, replace
file
    /home/research/ca_ed_lab/users/chesun/gsr/caschls/dta/demographics/pooled
    > /paneldata/secdemopanel.dta saved

. 
. 
. log close
      name:  <unnamed>
       log:  /home/research/ca_ed_lab/users/chesun/gsr/caschls/log/build/sample
> /pooledsecdemographics.smcl
  log type:  smcl
 closed on:  25 Jul 2022, 18:09:39
-------------------------------------------------------------------------------
